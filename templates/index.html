<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Real-Time Obamify</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body>
<h1>Draw & Obamify!</h1>

<div>
  <canvas id="drawCanvas" width="512" height="512" style="border:1px solid #000;"></canvas>
  <img id="obamaPreview" width="512" height="512">
</div>

<script>
const canvas = document.getElementById("drawCanvas");
const ctx = canvas.getContext("2d");
let drawing = false;

// Connect to the same host via Flask-SocketIO
const socket = io();

// Mouse events for drawing
canvas.onmousedown = () => drawing = true;
canvas.onmouseup = () => drawing = false;
canvas.onmouseleave = () => drawing = false;
canvas.onmousemove = (e) => {
    if (!drawing) return;
    ctx.fillRect(e.offsetX, e.offsetY, 4, 4); // brush size
    sendCanvas();
};

// Send canvas to server
function sendCanvas() {
    const dataURL = canvas.toDataURL("image/png");
    socket.emit('draw_data', dataURL);
}

// Receive updated morphed image
socket.on('update_image', (data) => {
    document.getElementById("obamaPreview").src = data;
});
</script>
</body>
</html>
